{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useCallback, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { GiftedChat, InputToolbar, Composer, Send, Bubble } from 'react-native-gifted-chat';\nimport messageApi from \"../api/messageApi\";\nimport { MaterialIcons } from '@expo/vector-icons';\nimport userApi from \"../api/userApi\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar SendMessageScreen = function SendMessageScreen(_ref) {\n  var route = _ref.route;\n  var _route$params = route.params,\n    senderId = _route$params.senderId,\n    receiverId = _route$params.receiverId;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    messages = _useState2[0],\n    setMessages = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    receiver = _useState4[0],\n    setReceiver = _useState4[1];\n  useEffect(function () {\n    var loadMessageHistory = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        try {\n          var receiverInfo = yield userApi.getUserInfo(receiverId);\n          setReceiver(receiverInfo);\n          var history = yield messageApi.getThread(senderId, receiverId);\n          var formattedHistory = history.map(function (msg) {\n            return {\n              _id: msg._id,\n              text: msg.text,\n              createdAt: new Date(msg.createdAt),\n              user: {\n                _id: msg.sender,\n                name: msg.sender.username\n              },\n              position: msg.sender === senderId ? 'right' : 'left'\n            };\n          });\n          setMessages(formattedHistory.reverse());\n        } catch (error) {\n          console.error('Error loading message history:', error);\n        }\n      });\n      return function loadMessageHistory() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    loadMessageHistory();\n  }, [senderId, receiverId]);\n  var onSend = useCallback(_asyncToGenerator(function* () {\n    var newMessages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var message = newMessages[0];\n    try {\n      yield messageApi.sendMessage({\n        sender: senderId,\n        receiver: receiverId,\n        text: message.text\n      });\n      setMessages(function (previousMessages) {\n        return GiftedChat.append(previousMessages, newMessages);\n      });\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  }), [senderId, receiverId]);\n  var renderSend = function renderSend(props) {\n    return _jsx(Send, _objectSpread(_objectSpread({}, props), {}, {\n      children: _jsx(View, {\n        style: styles.sendButton,\n        children: _jsx(MaterialIcons, {\n          name: \"send\",\n          size: 24,\n          color: \"white\"\n        })\n      })\n    }));\n  };\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsxs(View, {\n      style: styles.receiverContainer,\n      children: [_jsxs(Text, {\n        children: [\"Name: \", receiver.fullName]\n      }), _jsx(Image, {\n        source: receiver.profilePic\n      })]\n    }), _jsx(GiftedChat, {\n      messages: messages,\n      onSend: onSend,\n      user: {\n        _id: senderId\n      },\n      renderInputToolbar: function renderInputToolbar(props) {\n        return _jsx(InputToolbar, _objectSpread(_objectSpread({}, props), {}, {\n          containerStyle: {\n            backgroundColor: 'white'\n          }\n        }));\n      },\n      renderComposer: function renderComposer(props) {\n        return _jsx(Composer, _objectSpread(_objectSpread({}, props), {}, {\n          textInputStyle: {\n            color: 'black',\n            backgroundColor: 'white'\n          },\n          placeholder: \"Type a message...\"\n        }));\n      },\n      renderSend: renderSend,\n      renderBubble: function renderBubble(props) {\n        return _jsx(Bubble, _objectSpread(_objectSpread({}, props), {}, {\n          wrapperStyle: {\n            right: {\n              backgroundColor: '#007AFF'\n            },\n            left: {\n              backgroundColor: '#cccccc'\n            }\n          }\n        }));\n      },\n      parsePatterns: function parsePatterns(linkStyle) {\n        return [{\n          pattern: /#(\\w+)/,\n          style: {\n            color: 'orange',\n            textDecorationLine: 'underline'\n          },\n          onPress: function onPress(props) {\n            return alert(`Pressed on hashtag: ${props.text}`);\n          }\n        }];\n      },\n      timeFormat: \"LT\"\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  sendButton: {\n    marginRight: 10,\n    marginBottom: 5,\n    backgroundColor: '#007AFF',\n    borderRadius: 5,\n    paddingVertical: 5,\n    paddingHorizontal: 10\n  },\n  sendButtonText: {\n    color: 'white',\n    fontWeight: 'bold'\n  },\n  receiverContainer: {\n    flex: 1,\n    flexDirection: 'row'\n  }\n});\nexport default SendMessageScreen;","map":{"version":3,"names":["React","useState","useCallback","useEffect","View","StyleSheet","Text","GiftedChat","InputToolbar","Composer","Send","Bubble","messageApi","MaterialIcons","userApi","jsx","_jsx","jsxs","_jsxs","SendMessageScreen","_ref","route","_route$params","params","senderId","receiverId","_useState","_useState2","_slicedToArray","messages","setMessages","_useState3","_useState4","receiver","setReceiver","loadMessageHistory","_ref2","_asyncToGenerator","receiverInfo","getUserInfo","history","getThread","formattedHistory","map","msg","_id","text","createdAt","Date","user","sender","name","username","position","reverse","error","console","apply","arguments","onSend","newMessages","length","undefined","message","sendMessage","previousMessages","append","renderSend","props","_objectSpread","children","style","styles","sendButton","size","color","container","receiverContainer","fullName","Image","source","profilePic","renderInputToolbar","containerStyle","backgroundColor","renderComposer","textInputStyle","placeholder","renderBubble","wrapperStyle","right","left","parsePatterns","linkStyle","pattern","textDecorationLine","onPress","alert","timeFormat","create","flex","marginRight","marginBottom","borderRadius","paddingVertical","paddingHorizontal","sendButtonText","fontWeight","flexDirection"],"sources":["C:/Users/dyarb/batcave/Meetup_2.0/client/components/SendMessageScreen.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\r\nimport { View, StyleSheet, Text } from 'react-native';\r\nimport { GiftedChat, InputToolbar, Composer, Send, Bubble } from 'react-native-gifted-chat';\r\nimport messageApi from '../api/messageApi';\r\nimport { MaterialIcons } from '@expo/vector-icons'; // Import the desired icon library\r\nimport userApi from '../api/userApi';\r\n\r\nconst SendMessageScreen = ({ route }) => {\r\n  const { senderId, receiverId } = route.params;\r\n  const [messages, setMessages] = useState([]);\r\n  const [receiver, setReceiver] = useState(null)\r\n\r\n  useEffect(() => {\r\n\r\n    \r\n\r\n    const loadMessageHistory = async () => {\r\n      try {\r\n        const receiverInfo = await userApi.getUserInfo(receiverId);\r\n        setReceiver(receiverInfo);\r\n        const history = await messageApi.getThread(senderId, receiverId);\r\n        const formattedHistory = history.map((msg) => {\r\n          return {\r\n            _id: msg._id,\r\n            text: msg.text,\r\n            createdAt: new Date(msg.createdAt),\r\n            user: {\r\n              _id: msg.sender,\r\n              name: msg.sender.username,\r\n            },\r\n            position: msg.sender === senderId ? 'right' : 'left',\r\n          };\r\n        });\r\n\r\n        setMessages(formattedHistory.reverse());\r\n      } catch (error) {\r\n        console.error('Error loading message history:', error);\r\n      }\r\n    };\r\n\r\n    loadMessageHistory();\r\n  }, [senderId, receiverId]);\r\n\r\n  const onSend = useCallback(async (newMessages = []) => {\r\n    const message = newMessages[0];\r\n    try {\r\n      await messageApi.sendMessage({\r\n        sender: senderId,\r\n        receiver: receiverId,\r\n        text: message.text,\r\n      });\r\n\r\n      setMessages((previousMessages) => GiftedChat.append(previousMessages, newMessages));\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n    }\r\n  }, [senderId, receiverId]);\r\n\r\n  const renderSend = (props) => (\r\n    <Send {...props}>\r\n      <View style={styles.sendButton}>\r\n        <MaterialIcons name=\"send\" size={24} color=\"white\" />\r\n      </View>\r\n    </Send>\r\n  );\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.receiverContainer}>\r\n        <Text>Name: {receiver.fullName}</Text>\r\n        <Image source={receiver.profilePic}></Image>\r\n      </View>\r\n      <GiftedChat\r\n        messages={messages}\r\n        onSend={onSend}\r\n        user={{\r\n          _id: senderId,\r\n        }}\r\n        renderInputToolbar={(props) => (\r\n          <InputToolbar\r\n            {...props}\r\n            containerStyle={{ backgroundColor: 'white' }}\r\n          />\r\n        )}\r\n        renderComposer={(props) => (\r\n          <Composer\r\n            {...props}\r\n            textInputStyle={{ color: 'black', backgroundColor: 'white' }}\r\n            placeholder=\"Type a message...\"\r\n          />\r\n        )}\r\n        renderSend={renderSend}\r\n        renderBubble={(props) => (\r\n          <Bubble\r\n            {...props}\r\n            wrapperStyle={{\r\n              right: { backgroundColor: '#007AFF' },\r\n              left: { backgroundColor: '#cccccc' },\r\n            }}\r\n          />\r\n        )}\r\n        parsePatterns={(linkStyle) => [\r\n          {\r\n            pattern: /#(\\w+)/,\r\n            style: { color: 'orange', textDecorationLine: 'underline' },\r\n            onPress: (props) => alert(`Pressed on hashtag: ${props.text}`),\r\n          },\r\n        ]}\r\n        \r\n        timeFormat='LT'\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n  },\r\n  sendButton: {\r\n    marginRight: 10,\r\n    marginBottom: 5,\r\n    backgroundColor: '#007AFF', // Adjust the color as needed\r\n    borderRadius: 5,\r\n    paddingVertical: 5,\r\n    paddingHorizontal: 10,\r\n  },\r\n  sendButtonText: {\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n  },\r\n  receiverContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n  }\r\n});\r\n\r\nexport default SendMessageScreen;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}